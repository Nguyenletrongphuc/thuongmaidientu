<!DOCTYPE html>
<html lang="vn">
<head>
    <title>Sách Ơi - Home</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" type="text/css" href="asset/base.css"> -->
    <link rel="stylesheet" type="text/css" href="asset/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Dancing Script:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="asset/img/themify-icons-font/themify-icons/themify-icons.css">
    <!-- <link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css"> -->
    <script src="/asset/dongbodangnhap.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="grid">
                <nav class="header__navbar ">
                    <ul class="header__nav-list">
                        <li class="header__nav-item phancach">Vào cửa hàng trên ứng dụng</li>
                        <li class="header__nav-item">Kết nối
                            <a href="https://facebook.com" class="nav-item__icon">
                                <i class="ti-facebook"></i>
                            </a>
                            <a href="https://instagram.com" class="nav-item__icon">
                                <i class="ti-instagram"></i>
                            </a>
                        </li>
                        <li class="header__nav-item hearder__thongbao__hien">
                            <a href="" class="nav-item__icon">
                                <i class="ti-bell"></i>
                                Thông báo
                            </a>
                            <div class="hearder_thongbao">
                                <header class="hearder_thongbao-head">
                                    <h3>Thông Báo Mới</h3>
                                </header>
                                <ul class="hearder_thongbao_list">
                                    <li class="hearder_thongbao_list_item">
                                        <a href="" class="hearder_thongbao_link">
                                            <img src="https://ischool.vn/wp-content/uploads/2022/12/nhung-cuon-sach-hay-cho-tre-10-tuoi-3.jpg" alt="">
                                        <div class="hearder_thongbao_info">
                                            <p class="hearder_thongbao_name">Sách trẻ em</p>
                                            <p class="hearder_thongbao_mota">Phù hợp cho tuổi 5-10</p>
                                        </div>
                                        </a>
                                    </li>
                                </ul>
                                <footer class="hearder_thongbao-footer">
                                    <a href="" class="hearder_thongbao-footer-btn">Xem tất cả</a>
                                </footer>
                            </div>
                        </li>
                        <li class="header__nav-item">
                            <a href="" class="nav-item__icon">
                                <i class="ti-help-alt"></i>
                                Trợ giúp
                            </a>
                        </li>
                        <li class="header__nav-item">
                            <a href="admin2084.html" id="adminLink" class="go-admin">Admin</a>
                        </li>

                    </ul>
                    <ul class="header__nav-list">
                        <li class="header__nav_user_btn">
                            <button class="signup custom-btn btn-9">
                             <a href="signup.html">Đăng Nhập/Đăng Ký</a>
                            </button>
                        </li>
                    </ul>
                </nav>
            </div>
            <!-- phan tim kiem -->
            <div class="grid__timkiem">
                <div class="header__logo">
                    <a href="index.html" class="header__logo-link">
                        <img src="asset/img/logosachoi.png" alt="logo" class="header__logo-img">
                    </a>
                </div>
                <form id="searchForm" class="header__search">
                    <input type="text" id="searchInput" class="header__search-input" placeholder="Tìm kiếm sản phẩm">
                    <button type="submit" class="header__search-btn">
                        <i class="ti-search"></i>
                    </button>
                </form>
                <div class="header__cart">
                    <a href="giohang.html " class="header__cart-link">
                        <i class="ti-shopping-cart"></i>
                    </a>
                    <div class="header__cart_list header__cart_list__none ">
                        <img src="https://lucaga.com/assets/images/no-cart.png" alt="no__cart" class="no__cart__img">
                    </div>
                    
                </div>
                
        </header>
        
        <div class="slider">
    <div class="slider-row">
        <div class="slider-side">
            <img src="https://scontent.fsgn5-12.fna.fbcdn.net/v/t39.30808-6/496846002_1097513882407580_2221096940582546394_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=127cfc&_nc_ohc=kZsmZr3y35UQ7kNvwHNneQG&_nc_oc=AdnZIZM5mHYQafYhqEltB2HZdTAYYM0ohyOetSvLLu5nl7i2bUvUWIf1gY1djS39qtc&_nc_zt=23&_nc_ht=scontent.fsgn5-12.fna&_nc_gid=SgthB4zeW15HmkaZCxfXLg&oh=00_AfIC3LvmOE7Z9iLAo40SEZHik1R-o2pQMzYZpwWulSyiVg&oe=682F7AF6" alt="Banner trái" />
        </div>
        <div class="slider-center">
            <div class="slider-center-inner">
                <img class="mySlides" src="https://cdn1.fahasa.com/media/magentothem/banner7/muasamkhongtienmat_840x320T525.png" style="width:100%">
                <img class="mySlides" src="https://cdn1.fahasa.com/media/magentothem/banner7/ToBinhYenVeHanhPhuc_840x320.png" style="width:100%">
                <img class="mySlides" src="https://cdn1.fahasa.com/media/magentothem/banner7/CTT5_2505_840x320.png" style="width:100%">
            </div>
        </div>
        <div class="slider-side">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTiKbDALK-fccm9-r9xyILjbIJ6W6xlf9t7JQ&s" alt="Banner phải" />
        </div>
    </div>
</div>
        <div class="content">
            <div class="grid">
                <div class="grid_row">
                    <div class="grid_colum_2">
                        <nav class="catelory">
                            <ul class="catelory_list">
                                <h3 class="catelory_heading">
                                    <i class="ti-menu-alt"></i>
                                    Danh Mục</h3>
                                <li class="catelory_item">
                                    <a href="theloai.html?category=Truyện tranh" class="catelory_link">Truyện tranh</a>
                                </li>
                                <li class="catelory_item">
                                    <a href="theloai.html?category=Tiểu thuyết" class="catelory_link">Tiểu thuyết</a>
                                </li>
                                <li class="catelory_item">
                                    <a href="theloai.html?category=Văn học" class="catelory_link">Văn học</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    <div class="grid_colum_10">
                        <div class="home_filter">
                            <Span class="home_filter_lable">Sắp xếp theo</Span>
                            <button class="home_file_button">Phổ biến</button>
                            <button class="home_file_button">Mới nhất </button>
                            <button class="home_file_button">Bán chạy</button>
                        </div>
                        <div class="home_product">
                            <div class="grid_row_2" id="product-list"></div>
                                
                            </div>
                        </div>
                    </div>
                    <ul class="pagination pagination_margin">
                        <li class="pagination_item">
                            <a href="" class="pagination_item_link">
                                <i class="ti-angle-left"></i>
                            </a>
                        </li>
                        <li class="pagination_item pagination_item_active">
                            <a href="" class="pagination_item_link">1</a>
                        </li>
                        <li class="pagination_item ">
                            <a href="" class="pagination_item_link">2</a>
                        </li>
                        <li class="pagination_item">
                            <a href="" class="pagination_item_link">3</a>
                        </li>
                        <li class="pagination_item">
                            <a href="" class="pagination_item_link">...</a>
                        </li>
                        <li class="pagination_item">
                            <a href="" class="pagination_item_link">6</a>
                        </li>
                        <li class="pagination_item">
                            <a href="" class="pagination_item_link">
                                <i class="ti-angle-right"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
    </div>
    <div class="footer">
        <div class="footer-container">
            <div class="footer-col">
                <h3 class="footer-title">Sách Ơi - Kết nối tri thức</h3>
                <p class="footer-desc">Nền tảng thương mại điện tử sách hàng đầu, mang đến cho bạn trải nghiệm mua sắm tiện lợi, đa dạng và an toàn.</p>
                <div class="footer-social">
                    <a href="https://facebook.com" target="_blank" class="footer-social-link"><i class="ti-facebook"></i></a>
                    <a href="https://instagram.com" target="_blank" class="footer-social-link"><i class="ti-instagram"></i></a>
                    <a href="mailto:sachoi@email.com" class="footer-social-link"><i class="ti-email"></i></a>
                </div>
            </div>
            <div class="footer-col">
                <h3>Liên hệ</h3>
                <ul class="footer-contact">
                    <li><i class="ti-location-pin"></i> 123 Đường Sách, Quận 1, TP.HCM</li>
                    <li><i class="ti-mobile"></i> 0334 321 797</li>
                    <li><i class="ti-email"></i> sachoi@email.com</li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Về chúng tôi</h3>
                <ul class="footer-links">
                    <li><a href="#">Giới thiệu</a></li>
                    <li><a href="#">Điều khoản sử dụng</a></li>
                    <li><a href="#">Chính sách bảo mật</a></li>
                    <li><a href="#">Hỗ trợ khách hàng</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Đăng ký nhận tin</h3>
                <form class="footer-newsletter" onsubmit="event.preventDefault();alert('Cảm ơn bạn đã đăng ký!');">
                    <input type="email" placeholder="Nhập email của bạn" required>
                    <button type="submit"><i class="ti-arrow-right"></i></button>
                </form>
                <p class="footer-copyright">&copy; 2025 Sách Ơi. All rights reserved.</p>
            </div>
        </div>
    </div>
    </div>
    <script>
    // Xử lý tìm kiếm
    window.addEventListener("DOMContentLoaded", function () {
      document.getElementById("searchForm").addEventListener("submit", function(e) {
        e.preventDefault();
        const query = document.getElementById("searchInput").value.trim();
        if (query) {
          window.location.href = `timkiem.html?query=${encodeURIComponent(query)}`;
        }
      });
    });

    // Chuyển trang chi tiết sản phẩm
    function goToProductDetail(id) {
        window.location.href = `chitietsanpham.html?id=${id}`;
    }

    // Slider banner
    var myIndex = 0;
    carousel();
    function carousel() {
      var i;
      var x = document.getElementsByClassName("mySlides");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";  
      }
      myIndex++;
      if (myIndex > x.length) {myIndex = 1}    
      x[myIndex-1].style.display = "block";  
      setTimeout(carousel, 2000); // Change image every 2 seconds
    }

    // Phân trang và hiển thị sản phẩm
    let currentPage = 1;
    let totalPages = 1;

    async function fetchAndRenderProducts(page = 1) {
        try {
            const response = await fetch(`http://localhost:5000/api/products/get-products?page=${page}&limit=15`);
            const data = await response.json();
            const products = data.products;
            totalPages = data.totalPages;
            currentPage = data.page;

            // Render sản phẩm
            const productContainer = document.querySelector(".grid_row_2");
            productContainer.innerHTML = "";
            products.forEach(product => {
                const productHTML = `
                    <div class="grid_colum_2_4">
                        <div class="home_product_item" onclick="goToProductDetail('${product._id}')">
                            <div class="home_product_item_img" style="background-image: url(${product.image});"></div>
                            <h4 class="home_product_item_name">${product.name}</h4>
                            <p class="home_product_item_price">Giá: ${product.price.toLocaleString("vi-VN")} vnđ</p>
                            <div class="home_product_item_action">
                                <button class="add-to-cart-btn" onclick="event.stopPropagation(); addToCart(${JSON.stringify(product)})">
                                    Thêm vào giỏ
                                </button>
                                <span class="like">
                                    <i class="saled">Số lượng ${product.quantity}</i>
                                </span>
                            </div>
                        </div>
                    </div>
                `;
                productContainer.innerHTML += productHTML;
            });

            // Render phân trang
            renderPagination();
        } catch (error) {
            console.error("Lỗi khi lấy sản phẩm:", error);
        }
    }

    function renderPagination() {
        const pagination = document.querySelector(".pagination");
        if (!pagination) return;
        let html = '';

        // Nút prev
        html += `<li class="pagination_item${currentPage === 1 ? ' pagination_item_disabled' : ''}">
            <a href="#" class="pagination_item_link" data-page="${currentPage - 1}"><i class="ti-angle-left"></i></a>
        </li>`;

        // Số trang
        for (let i = 1; i <= totalPages; i++) {
            html += `<li class="pagination_item${i === currentPage ? ' pagination_item_active' : ''}">
                <a href="#" class="pagination_item_link" data-page="${i}">${i}</a>
            </li>`;
        }

        // Nút next
        html += `<li class="pagination_item${currentPage === totalPages ? ' pagination_item_disabled' : ''}">
            <a href="#" class="pagination_item_link" data-page="${currentPage + 1}"><i class="ti-angle-right"></i></a>
        </li>`;

        pagination.innerHTML = html;

        // Gán sự kiện click
        document.querySelectorAll('.pagination_item_link').forEach(link => {
            link.onclick = function(e) {
                e.preventDefault();
                const page = parseInt(this.getAttribute('data-page'));
                if (page >= 1 && page <= totalPages && page !== currentPage) {
                    fetchAndRenderProducts(page);
                }
            }
        });
    }

    // Khởi động lần đầu
    document.addEventListener("DOMContentLoaded", function () {
        fetchAndRenderProducts(1);
    });

    // Dummy addToCart function (nếu chưa có)
    function addToCart(product) {
        alert("Đã thêm sản phẩm vào giỏ: " + product.name);
    }
    </script>
</body>
</html>